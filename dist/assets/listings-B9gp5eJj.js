import{g as f,r as g}from"./main-D9sgWMsp.js";function m(n){const e=document.getElementById("filter-menu"),t=document.querySelector(".filter-btn"),i=document.getElementById("close-filter-btn"),r=document.querySelector("#filter-tags"),o=document.querySelector("#search");if(!e||!t)return;async function u(){let c=n;c||(c=await f());const s={};c.forEach(l=>{(l.tags||[]).forEach(a=>{s[a]=(s[a]||0)+1})}),r.innerHTML="",Object.entries(s).forEach(([l,a])=>{const d=document.createElement("p");d.textContent=`${l} (${a})`,d.className="cursor-pointer hover:underline",d.addEventListener("click",()=>{window.location.href=`/listings?tag=${encodeURIComponent(l)}`}),r.appendChild(d)})}u(),t.addEventListener("click",()=>{e.classList.toggle("hidden")}),i&&i.addEventListener("click",()=>{e.classList.add("hidden")}),o&&o.addEventListener("keypress",c=>{if(c.key==="Enter"){const s=o.value.trim();s&&(window.location.href=`/listings?search=${encodeURIComponent(s)}`)}})}async function h(){try{const n=await f(),e=new URLSearchParams(window.location.search),t=e.get("search")?.toLowerCase()||"",i=e.get("tag")||"";let r=[...n];i&&(r=r.filter(o=>o.tags?.includes(i))),t&&(r=r.filter(o=>o.title.toLowerCase().includes(t)||o.description?.toLowerCase().includes(t))),L(i,t),g(r),m(n)}catch(n){console.error("Failed to load listings:",n);const e=document.querySelector("#soon-grid");e&&(e.innerHTML="<p>Failed to load listings.</p>")}}function L(n,e){const t=document.getElementById("active-filter");if(!t||(t.innerHTML="",!n&&!e))return;const i=n?`Tag: ${n}`:`Search: ${e}`;t.innerHTML=`
    <button 
      id="clear-filter-btn"
      class="border border-main bg-main text-white rounded-xl px-3 py-1 text-sm cursor-pointer"
    >
      ${i} âœ•
    </button>
  `,document.getElementById("clear-filter-btn").addEventListener("click",()=>{window.location.href="/listings"})}h();
